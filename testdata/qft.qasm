OPENQASM 3.0;

gate x q { U(pi, 0, pi) q; }
gate h q { U(pi/2.0, 0, pi) q; }
gate rz(theta) q { U(0, 0, theta) q; }
gate cx c, t { ctrl @ U(pi, 0, pi) c, t; }
gate crz(theta) c, t { ctrl @ U(0, 0, theta) c, t; }

def qft(qubit[3] q) {
    h q[0];
    crz(pi/2) q[0], q[1];
    crz(pi/4) q[0], q[2];

    h q[1];
    crz(pi/2) q[1], q[2];

    h q[2];

    // swap
    cx q[0], q[2];
    cx q[2], q[0];
    cx q[0], q[2];
}

qubit[3] q;
x q[2];
qft(q);

// [000][  0]( 0.3536 0.0000i): 0.1250
// [001][  1]( 0.2500 0.2500i): 0.1250
// [010][  2]( 0.0000 0.3536i): 0.1250
// [011][  3](-0.2500 0.2500i): 0.1250
// [100][  4](-0.3536 0.0000i): 0.1250
// [101][  5](-0.2500-0.2500i): 0.1250
// [110][  6]( 0.0000-0.3536i): 0.1250
// [111][  7]( 0.2500-0.2500i): 0.1250
